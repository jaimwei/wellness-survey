<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Santa Monica Proper - Wellness Experience Survey</title>
    
    <!-- Import fonts first -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600&family=Crimson+Text:wght@400;600&family=Work+Sans:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Santa Monica Proper Hotel Brand Colors and Fonts */
        
        /* Brand Colors */
        :root {
            --smp-cream: #f4f2f0;
            --smp-black: #000000;
        }
        
        @font-face {
            font-family: 'ABC Arizona Mix';
            src: url('ABCArizonaMix-Light.woff2') format('woff2'),
                 url('ABCArizonaMix-Light.woff') format('woff');
            font-weight: 300;
            font-style: normal;
        }
        
        @font-face {
            font-family: 'ABC Arizona Mix';
            src: url('ABCArizonaMix-LightItalic.woff2') format('woff2'),
                 url('ABCArizonaMix-LightItalic.woff') format('woff');
            font-weight: 300;
            font-style: italic;
        }
        
        @font-face {
            font-family: 'Benton Sans';
            src: url('BentonSans-RE.ttf') format('truetype');
            font-weight: 400;
            font-style: normal;
        }
        
        @font-face {
            font-family: 'Benton Sans';
            src: url('BentonSans-REBold.ttf') format('truetype');
            font-weight: 700;
            font-style: normal;
        }
        
        @font-face {
            font-family: 'Benton Sans';
            src: url('BentonSans-REItalic.ttf') format('truetype');
            font-weight: 400;
            font-style: italic;
        }
        
        @font-face {
            font-family: 'Benton Sans';
            src: url('BentonSans-WideBold.otf') format('opentype');
            font-weight: 800;
            font-style: normal;
        }
        
        .smp-header {
            font-family: 'ABC Arizona Mix', Georgia, serif;
            font-weight: 300;
            letter-spacing: 0.08em;
        }
        
        .smp-body {
            font-family: 'ABC Arizona Mix', Georgia, serif;
            font-weight: 300;
        }
        
        .survey-title {
            font-family: 'Benton Sans', sans-serif;
            font-weight: 800;
            letter-spacing: 0.2em;
            font-size: 18px;
            line-height: 1.2;
            text-transform: uppercase;
        }
        
        /* Custom styling */
        body {
            background-color: #f4f2f0;
            color: #000000;
        }
        
        .step-content {
            display: none;
        }
        
        .step-content.active {
            display: block;
        }
        
        .option-card {
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid rgba(0, 0, 0, 0.1);
            background-color: rgba(255, 255, 255, 0.5);
        }
        
        .option-card:hover {
            background-color: rgba(243, 244, 246, 0.5);
        }
        
        .option-card.selected {
            border: 2px solid #000000;
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        .btn-primary {
            background-color: #000000;
            border: 1px solid #000000;
            color: #f4f2f0;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .btn-primary:hover:not(:disabled) {
            background-color: rgba(255, 255, 255, 0.5);
            color: #000000;
        }
        
        .btn-primary:disabled {
            background-color: rgba(255, 255, 255, 0.3);
            color: #999999;
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        input, select, textarea {
            border: 1px solid rgba(0, 0, 0, 0.1);
            background-color: rgba(255, 255, 255, 0.8);
            color: #000000;
            height: auto;
            min-height: 44px;
        }
        
        select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
        }
        
        .survey-container {
            background-color: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .profile-summary {
            background-color: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .day-header {
            background-color: #000000;
            color: #ffffff;
        }
        
        .contact-section {
            background-color: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .day-container {
            margin-bottom: 30px;
            background-color: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .activity-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding-bottom: 15px;
            margin-bottom: 15px;
            position: relative;
        }
        
        .activity-item:not(:last-child) {
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        }
        
        .swap-btn {
            position: absolute;
            top: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: #000;
            font-size: 10px;
            padding: 4px 8px;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.2s ease;
        }
        
        .swap-btn:hover {
            background: #000;
            color: #f4f2f0;
        }
        
        .activity-item.swappable {
            border: 1px dashed rgba(0, 0, 0, 0.2);
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .swap-options {
            display: none;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
            padding: 15px;
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
            position: absolute;
            right: 0;
            top: 30px;
            min-width: 300px;
            z-index: 10;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .swap-options.active {
            display: block;
        }
        
        .swap-option {
            padding: 8px;
            cursor: pointer;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            font-size: 11px;
        }
        
        .swap-option:hover {
            background: rgba(0, 0, 0, 0.05);
        }
        
        .swap-option:last-child {
            border-bottom: none;
        }
        
        .activity-time {
            font-size: 10px;
            color: #000000;
            font-weight: 400;
            width: 80px;
            flex-shrink: 0;
            padding-top: 2px;
        }
        
        .activity-content {
            flex: 1;
        }
        
        .activity-title {
            font-size: 11px;
            color: #000000;
            font-weight: 700;
            letter-spacing: 0.8px;
            text-transform: uppercase;
            margin-bottom: 4px;
        }
        
        .activity-location {
            font-size: 10px;
            color: #777777;
            font-weight: 400;
            margin-bottom: 6px;
        }
        
        .activity-description {
            font-size: 11px;
            color: #666666;
            line-height: 1.4;
        }
    </style>
</head>
<body class="min-h-screen smp-body">
    <div class="max-w-xl mx-auto min-h-screen">
        <!-- Header -->
        <div class="px-6 pt-9 pb-5 text-center">
            <div class="text-center mb-5">
                <!-- Santa Monica Proper Logo -->
                <div class="flex justify-center mb-5">
                    <img 
                        src="santa_monica_proper_logo.png" 
                        alt="Santa Monica Proper Hotel"
                        class="h-16 w-auto"
                        style="max-height: 4rem;"
                    />
                </div>
                
                <h1 class="survey-title tracking-widest uppercase mb-4" style="font-weight: 600; color: #000000;">
                    WELLNESS EXPERIENCE SURVEY
                </h1>

                <!-- Survey Purpose -->
                <div class="smp-body text-sm leading-relaxed max-w-sm mx-auto p-4 border" 
                     style="background-color: rgba(255, 255, 255, 0.3); border-color: rgba(0, 0, 0, 0.1); color: #000000;">
                    Help us create your personalized wellness itinerary. This brief survey will generate a detailed day-by-day schedule of activities, treatments, and dining experiences tailored to your preferences and your stay.
                </div>
            </div>
            
            <p class="smp-body text-xs uppercase tracking-wide text-center" style="color: #777777;">
                Step <span id="current-step">1</span> of <span id="total-steps">6</span>
            </p>
        </div>

        <!-- Survey Content -->
        <div class="survey-container mx-6 mb-6 p-6">
            <h2 class="smp-header text-xs tracking-wide uppercase mb-5" id="step-title">
                Guest Information
            </h2>
            
            <!-- Step 1: Guest Information -->
            <div class="step-content active" id="step-1">
                <div class="grid grid-cols-1 gap-5">
                    <div>
                        <label class="smp-header block text-sm tracking-wide uppercase mb-2" style="font-weight: 400; color: #000000;">
                            Guest Name(s) *
                        </label>
                        <input
                            type="text"
                            id="guest-names"
                            placeholder="John & Jane Smith"
                            class="smp-body w-full p-3 text-sm"
                        />
                    </div>

                    <div>
                        <label class="smp-header block text-sm tracking-wide uppercase mb-2">
                            Who are you traveling with? *
                        </label>
                        <select id="party-type" class="smp-body w-full p-3 text-sm">
                            <option value="">Select...</option>
                            <option value="solo">Just me</option>
                            <option value="couple">My partner and I</option>
                            <option value="family">My family (with kids)</option>
                            <option value="friends">A group of friends</option>
                            <option value="business">Business colleagues</option>
                        </select>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="smp-header block text-sm tracking-wide uppercase mb-2">
                                Arrival Date *
                            </label>
                            <input
                                type="date"
                                id="arrival-date"
                                class="smp-body w-full p-3 text-sm"
                            />
                        </div>

                        <div>
                            <label class="smp-header block text-sm tracking-wide uppercase mb-2">
                                Estimated Arrival Time
                            </label>
                            <select id="arrival-time" class="smp-body w-full p-3 text-sm">
                                <option value="">Select...</option>
                                <option value="early-morning">Early Morning (6-9 AM)</option>
                                <option value="morning">Morning (9 AM-12 PM)</option>
                                <option value="afternoon">Afternoon (12-4 PM)</option>
                                <option value="evening">Evening (4-8 PM)</option>
                                <option value="late-evening">Late Evening (8 PM+)</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="smp-header block text-sm tracking-wide uppercase mb-2">
                                Length of Stay *
                            </label>
                            <select id="length-of-stay" class="smp-body w-full p-3 text-sm">
                                <option value="">Select...</option>
                                <option value="1">1 night</option>
                                <option value="2">2 nights</option>
                                <option value="3">3 nights</option>
                                <option value="4">4 nights</option>
                                <option value="5">5 nights</option>
                                <option value="6-7">6-7 nights</option>
                                <option value="week+">1 week or more</option>
                            </select>
                        </div>

                        <div>
                            <label class="smp-header block text-sm tracking-wide uppercase mb-2">
                                Estimated Departure Time
                            </label>
                            <select id="departure-time" class="smp-body w-full p-3 text-sm">
                                <option value="">Select...</option>
                                <option value="early-morning">Early Morning (6-9 AM)</option>
                                <option value="morning">Morning (9 AM-12 PM)</option>
                                <option value="afternoon">Afternoon (12-4 PM)</option>
                                <option value="evening">Evening (4-8 PM)</option>
                                <option value="flexible">Flexible/Late Checkout</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label class="smp-header block text-sm tracking-wide uppercase mb-2">
                            Occasion (Optional)
                        </label>
                        <select id="travel-purpose" class="smp-body w-full p-3 text-sm">
                            <option value="">Select...</option>
                            <option value="leisure">Leisure/Vacation</option>
                            <option value="business">Business Travel</option>
                            <option value="anniversary">Anniversary/Romance</option>
                            <option value="birthday">Birthday Celebration</option>
                            <option value="wellness-retreat">Dedicated Wellness Retreat</option>
                            <option value="other">Other Special Occasion</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Step 2: Energy Level -->
            <div class="step-content" id="step-2">
                <p class="smp-body text-xs leading-relaxed mb-5" style="color: #666666;">
                    This helps us match the right intensity level for your wellness experience:
                </p>
                <div class="grid gap-4">
                    <div class="option-card p-5" data-value="high-activity">
                        <h3 class="smp-header text-xs tracking-wide uppercase mb-2">
                            High Activity
                        </h3>
                        <p class="smp-body text-xs leading-relaxed mb-2" style="color: #666666;">
                            I want challenging workouts, intense experiences, and active adventures
                        </p>
                        <p class="smp-body text-xs italic leading-tight" style="color: #999999;">
                            HIIT classes, personal training, VO2 max testing, tennis coaching, padel, beach volleyball, run club
                        </p>
                    </div>
                    <div class="option-card p-5" data-value="balanced">
                        <h3 class="smp-header text-xs tracking-wide uppercase mb-2">
                            Balanced Mix
                        </h3>
                        <p class="smp-body text-xs leading-relaxed mb-2" style="color: #666666;">
                            I want some active moments balanced with relaxing experiences
                        </p>
                        <p class="smp-body text-xs italic leading-tight" style="color: #999999;">
                            Yoga classes, pilates, moderate spa treatments, pool time, recovery suite sessions
                        </p>
                    </div>
                    <div class="option-card p-5" data-value="restorative">
                        <h3 class="smp-header text-xs tracking-wide uppercase mb-2">
                            Restorative Focus
                        </h3>
                        <p class="smp-body text-xs leading-relaxed mb-2" style="color: #666666;">
                            I prefer gentle, calming, and deeply relaxing experiences
                        </p>
                        <p class="smp-body text-xs italic leading-tight" style="color: #999999;">
                            Gentle yoga, spa treatments, sound baths, meditation, proper club lounge, beach walks
                        </p>
                    </div>
                </div>
            </div>

            <!-- Step 3: Wellness Interests -->
            <div class="step-content" id="step-3">
                <p class="smp-body text-xs leading-relaxed mb-5" style="color: #666666;">
                    Select all wellness areas that interest you during your stay (choose multiple):
                </p>
                <div class="grid gap-4">
                    <div class="option-card p-5" data-value="movement">
                        <h3 class="smp-header text-xs tracking-wide uppercase mb-2">
                            Movement & Fitness
                        </h3>
                        <p class="smp-body text-xs leading-relaxed mb-2" style="color: #666666;">
                            Physical activity, exercise, and fitness training
                        </p>
                        <p class="smp-body text-xs italic leading-tight" style="color: #999999;">
                            Personal training, HIIT classes, vinyasa yoga, pilates, VO2 Max testing ($150), tennis coaching, padel, run club
                        </p>
                    </div>
                    <div class="option-card p-5" data-value="spa">
                        <h3 class="smp-header text-xs tracking-wide uppercase mb-2">
                            Spa & Ayurvedic Treatments
                        </h3>
                        <p class="smp-body text-xs leading-relaxed mb-2" style="color: #666666;">
                            Spa treatments and Ayurvedic wellness experiences
                        </p>
                        <p class="smp-body text-xs italic leading-tight" style="color: #999999;">
                            Surya Spa treatments (15% off), Shirodhara, Abhyanga massage, sound baths, breathwork, ayurvedic consultations
                        </p>
                    </div>
                    <div class="option-card p-5" data-value="recovery">
                        <h3 class="smp-header text-xs tracking-wide uppercase mb-2">
                            Recovery & Technology
                        </h3>
                        <p class="smp-body text-xs leading-relaxed mb-2" style="color: #666666;">
                            Recovery, restoration, and wellness technology
                        </p>
                        <p class="smp-body text-xs italic leading-tight" style="color: #999999;">
                            Recovery Suite ($245-$345), cold plunge, dry sauna, red light therapy, compression therapy, Proper Club Lounge ($195/day)
                        </p>
                    </div>
                    <div class="option-card p-5" data-value="outdoor">
                        <h3 class="smp-header text-xs tracking-wide uppercase mb-2">
                            Outdoor & Beach Activities
                        </h3>
                        <p class="smp-body text-xs leading-relaxed mb-2" style="color: #666666;">
                            Outdoor experiences and Santa Monica natural setting
                        </p>
                        <p class="smp-body text-xs italic leading-tight" style="color: #999999;">
                            Rooftop pool, beach tennis, tennis coaching, padel, sunset yoga, beach walks, guided hikes
                        </p>
                    </div>
                    <div class="option-card p-5" data-value="dining">
                        <h3 class="smp-header text-xs tracking-wide uppercase mb-2">
                            Wellness Dining & Lifestyle
                        </h3>
                        <p class="smp-body text-xs leading-relaxed mb-2" style="color: #666666;">
                            Healthy eating, Ayurvedic nutrition, and lifestyle
                        </p>
                        <p class="smp-body text-xs italic leading-tight" style="color: #999999;">
                            Proper Club Lounge ($195/day), Surya Ayurvedic lattes, wellness bowls, healthy dining at Palma & Calabra
                        </p>
                    </div>
                </div>
            </div>

            <!-- Step 4: Timing Preference -->
            <div class="step-content" id="step-4">
                <p class="smp-body text-xs leading-relaxed mb-5" style="color: #666666;">
                    When do you prefer your wellness activities?
                </p>
                <div class="grid gap-3">
                    <div class="option-card p-4" data-value="early-bird">
                        <h3 class="smp-header text-xs tracking-wide uppercase mb-1">
                            Early Bird (6-10 AM)
                        </h3>
                        <p class="smp-body text-xs leading-relaxed" style="color: #666666;">
                            I love starting my day with wellness activities
                        </p>
                    </div>
                    <div class="option-card p-4" data-value="mid-day">
                        <h3 class="smp-header text-xs tracking-wide uppercase mb-1">
                            Mid-Day (10 AM - 4 PM)
                        </h3>
                        <p class="smp-body text-xs leading-relaxed" style="color: #666666;">
                            I prefer wellness activities during the day
                        </p>
                    </div>
                    <div class="option-card p-4" data-value="evening">
                        <h3 class="smp-header text-xs tracking-wide uppercase mb-1">
                            Evening (4-8 PM)
                        </h3>
                        <p class="smp-body text-xs leading-relaxed" style="color: #666666;">
                            I like to wind down with wellness in the evening
                        </p>
                    </div>
                    <div class="option-card p-4" data-value="flexible">
                        <h3 class="smp-header text-xs tracking-wide uppercase mb-1">
                            Flexible Scheduling
                        </h3>
                        <p class="smp-body text-xs leading-relaxed" style="color: #666666;">
                            I am open to activities at various times
                        </p>
                    </div>
                </div>
            </div>

            <!-- Step 5: Special Notes -->
            <div class="step-content" id="step-5">
                <p class="smp-body text-xs leading-relaxed mb-4" style="color: #666666;">
                    Any special considerations or goals for your wellness experience?
                </p>
                <textarea
                    id="special-notes"
                    placeholder="Optional - Examples:
• Dietary restrictions or preferences
• Physical limitations or injuries to consider
• Specific wellness goals
• Celebrating a special occasion
• Previous experience with Ayurveda or specific treatments
• Booking preferences (advance vs. spontaneous)"
                    rows="8"
                    class="smp-body w-full p-4 text-sm resize-none leading-relaxed"
                ></textarea>
            </div>

            <!-- Step 6: Results -->
            <div class="step-content" id="step-6">
                <!-- Results will be populated by JavaScript -->
            </div>
        </div>

        <!-- Navigation -->
        <div class="flex justify-between px-6 pb-10">
            <button
                id="prev-btn"
                class="btn-primary smp-body px-4 py-2 text-xs tracking-wide uppercase"
                onclick="goToPreviousStep()"
            >
                Previous
            </button>

            <button
                id="next-btn"
                class="btn-primary smp-body px-4 py-2 text-xs tracking-wide uppercase"
                onclick="goToNextStep()"
            >
                Next
            </button>

            <button
                id="complete-btn"
                class="btn-primary smp-body px-4 py-2 text-xs tracking-wide uppercase"
                style="display: none;"
                onclick="downloadPDF()"
            >
                Download Itinerary
            </button>
        </div>
    </div>

    <script>
        // Global survey state
        let currentStep = 1;
        const totalSteps = 6;
        let surveyData = {
            names: '',
            partyType: '',
            arrivalDate: '',
            arrivalTime: '',
            lengthOfStay: '',
            departureTime: '',
            travelPurpose: '',
            energyLevel: '',
            interests: [],
            timing: '',
            notes: ''
        };

        const stepTitles = [
            'Guest Information',
            'Energy Level', 
            'Wellness Interests',
            'Timing Preference',
            'Special Notes',
            'Your Personalized Itinerary'
        ];

        // Comprehensive wellness activities database with all 63+ experiences
        const wellnessDatabase = {
            // Fitness Classes (exact schedule enforcement)
            fitnessClasses: {
                'Monday': [
                    { time: '8:00 AM', title: 'HIIT', location: 'Helios Studio', description: 'High-intensity interval training combining cardio and strength movements for maximum results.', price: 'Complimentary', duration: 60, energyLevel: ['high-activity', 'balanced'], bookingText: 'Reserve on Eventbrite', eventbriteUrl: 'https://www.eventbrite.com/e/hiit-class-tickets-1345494964659?aff=oddtdtcreator', swappable: true },
                    { time: '4:00 PM', title: 'Flow Yoga', location: 'Helios Studio', description: 'Dynamic sequences connecting breath and movement in a flowing practice.', price: 'Complimentary', duration: 60, energyLevel: ['balanced', 'restorative'], bookingText: 'Reserve on Eventbrite', eventbriteUrl: 'https://www.eventbrite.com/e/flow-yoga-tickets-1345491484249?aff=oddtdtcreator', swappable: true }
                ],
                'Tuesday': [
                    { time: '8:00 AM', title: 'Vinyasa Yoga', location: 'Helios Studio', description: 'Energizing flow-based yoga linking postures with mindful breathing.', price: 'Complimentary', duration: 60, energyLevel: ['balanced', 'high-activity'], bookingText: 'Reserve on Eventbrite', eventbriteUrl: 'https://www.eventbrite.com/e/vinyasa-yoga-tickets-1345496980689?aff=oddtdtcreator', swappable: true },
                    { time: '6:30 PM', title: 'Yoga Flow & Chill', location: 'Helios Studio', description: 'A relaxing evening yoga flow that combines gentle movement with restorative poses for deep relaxation.', price: 'Complimentary', duration: 60, energyLevel: ['restorative', 'balanced'], bookingText: 'Reserve on Eventbrite', eventbriteUrl: 'https://www.eventbrite.com/e/yoga-flow-chill-tickets-1442640178609?aff=oddtdtcreator', swappable: true }
                ],
                'Wednesday': [
                    { time: '7:30 AM', title: 'Proper Run Club', location: 'Paseo', description: 'Guided running sessions exploring Santa Monica\'s scenic coastal routes.', price: 'Complimentary', duration: 60, energyLevel: ['high-activity', 'balanced'], bookingText: 'Reserve on Eventbrite', eventbriteUrl: 'https://www.eventbrite.com/e/proper-run-club-tickets-1364483429669?aff=oddtdtcreator', swappable: true },
                    { time: '8:00 AM', title: 'Mat Pilates', location: 'Helios Studio', description: 'Core-strengthening exercises emphasizing precision, control, and alignment.', price: 'Complimentary', duration: 60, energyLevel: ['balanced', 'high-activity'], bookingText: 'Reserve on Eventbrite', eventbriteUrl: 'https://www.eventbrite.com/e/mat-pilates-tickets-1304652182799?aff=oddtdtcreator', swappable: true },
                    { time: '10:00 AM', title: 'Yoga Sculpt', location: 'Helios Studio', description: 'Yoga combined with light weights for strength building and toning.', price: 'Complimentary', duration: 60, energyLevel: ['high-activity', 'balanced'], bookingText: 'Reserve on Eventbrite', eventbriteUrl: 'https://www.eventbrite.com/e/yoga-sculpt-tickets-1350581308049?aff=oddtdtcreator', swappable: true }
                ],
                'Thursday': [
                    { time: '6:30 AM', title: 'Surya Dosha Yoga', location: 'Helios Studio', description: 'Energizing morning practice designed to awaken and invigorate the body.', price: 'Complimentary', duration: 60, energyLevel: ['balanced', 'restorative'], bookingText: 'Reserve on Eventbrite', eventbriteUrl: 'https://www.eventbrite.com/e/surya-dosha-yoga-energizing-tickets-1338767853689?aff=oddtdtcreator', swappable: true }
                ],
                'Friday': [
                    { time: '8:00 AM', title: 'Gentle Yoga', location: 'Helios Studio', description: 'Restorative practice focusing on relaxation and gentle movement.', price: 'Complimentary', duration: 60, energyLevel: ['restorative', 'balanced'], bookingText: 'Reserve on Eventbrite', eventbriteUrl: 'https://www.eventbrite.com/e/gentle-yoga-tickets-1304683175499?aff=oddtdtcreator', swappable: true }
                ],
                'Saturday': [
                    { time: '8:45 AM', title: 'Vinyasa Yoga', location: 'Helios Studio', description: 'Energizing flow-based yoga linking postures with mindful breathing.', price: 'Complimentary', duration: 60, energyLevel: ['balanced', 'high-activity'], bookingText: 'Reserve on Eventbrite', eventbriteUrl: 'https://www.eventbrite.com/e/vinyasa-yoga-tickets-1304691791269?aff=oddtdtcreator', swappable: true },
                    { time: '10:45 AM', title: 'Pilates', location: 'Helios Studio', description: 'Full-body conditioning emphasizing core strength, flexibility, and posture.', price: 'Complimentary', duration: 60, energyLevel: ['balanced', 'high-activity'], bookingText: 'Reserve on Eventbrite', eventbriteUrl: 'https://www.eventbrite.com/e/pilates-tickets-1378940902359?aff=oddtdtcreator', swappable: true }
                ],
                'Sunday': [
                    { time: '9:00 AM', title: 'Vinyasa Yoga', location: 'Helios Studio', description: 'Energizing flow-based yoga linking postures with mindful breathing.', price: 'Complimentary', duration: 60, energyLevel: ['balanced', 'high-activity'], bookingText: 'Reserve on Eventbrite', eventbriteUrl: 'https://www.eventbrite.com/e/vinyasa-yoga-tickets-1264416918039?aff=oddtdtcreator', swappable: true },
                    { time: '10:30 AM', title: 'Mat Pilates', location: 'Helios Studio', description: 'Core-strengthening exercises emphasizing precision, control, and alignment.', price: 'Complimentary', duration: 60, energyLevel: ['balanced', 'high-activity'], bookingText: 'Reserve on Eventbrite', eventbriteUrl: 'https://www.eventbrite.com/e/mat-pilates-tickets-1264391090789?aff=oddtdtcreator', swappable: true }
                ]
            },

            // Time-categorized swap activities
            morningActivities: [
                { time: '7:00 AM', title: 'Morning Beach Walk', location: 'Santa Monica Beach', description: 'Energizing sunrise walk along the shore to start your day with ocean views.', price: 'Complimentary', energyLevel: ['high-activity', 'balanced', 'restorative'], bookingText: 'Meet at Lobby', interests: ['outdoor'] },
                { time: '7:30 AM', title: 'Morning Coffee & Tea Service', location: 'Canela Lounge - Ground Floor', description: 'Counter Culture Coffee and artisanal tea service to start your day.', price: 'Complimentary', energyLevel: ['high-activity', 'balanced', 'restorative'], bookingText: '', interests: ['dining'] },
                { time: '8:00 AM', title: 'Personal Training Session', location: 'Helios Studio', description: 'One-on-one fitness coaching tailored to your goals and fitness level.', price: 'Additional fee', energyLevel: ['high-activity', 'balanced'], bookingText: 'Book Personal Training', interests: ['movement'] },
                { time: '9:00 AM', title: 'Wellness Breakfast at Palma', location: 'Palma Restaurant', description: 'Greek Goddess Yogurt Parfait, Sprouted Overnight Oats, or Avocado Toast with fresh market fruit.', price: 'Menu pricing', energyLevel: ['high-activity', 'balanced', 'restorative'], bookingText: 'Reserve on OpenTable', interests: ['dining'] },
                { time: '10:00 AM', title: 'Surya Spa Ayurvedic Lattes', location: 'Palma Restaurant', description: 'Brainpower Latte, Whole Body Energy Latte, or Mighty Turmeric Latte crafted by Surya Spa.', price: 'Menu pricing', energyLevel: ['balanced', 'restorative'], bookingText: 'Walk-in Available', interests: ['dining'] },
                { time: '10:30 AM', title: 'VO2 Max Testing Session', location: 'Performance Lab - Fitness Center', description: 'Professional VO2 max test measuring maximal oxygen uptake. Includes digital report.', price: '$150', energyLevel: ['high-activity', 'balanced'], bookingText: 'Book VO2 Testing', interests: ['movement'] }
            ],
            
            midDayActivities: [
                { time: '11:00 AM', title: 'Pool Time & Relaxation', location: 'Pool Deck', description: 'Unwind at the rooftop pool with stunning ocean views.', price: 'Complimentary', energyLevel: ['restorative', 'balanced'], bookingText: 'Walk-in Available', interests: ['outdoor'] },
                { time: '11:00 AM', title: '60-Minute Recovery Suite', location: 'Recovery Suite', description: 'Fully immersive wellness experience with Ammortal Chamber, dry sauna, cold plunge, red light therapy.', price: '$245', energyLevel: ['balanced', 'restorative'], bookingText: 'Reserve Recovery Suite', interests: ['recovery'] },
                { time: '12:00 PM', title: 'Healthy Lunch at Palma', location: 'Palma Restaurant', description: 'Farmers Market Salad, Kale Pesto, or Pan Seared Salmon with Mediterranean sides.', price: 'Menu pricing', energyLevel: ['high-activity', 'balanced', 'restorative'], bookingText: 'Reserve on OpenTable', interests: ['dining'] },
                { time: '1:00 PM', title: 'Shirodhara Session', location: 'Surya Spa', description: 'Warm oil therapy streamed over your forehead for mental clarity and stress relief.', price: 'Additional fee (15% off)', energyLevel: ['restorative', 'balanced'], bookingText: 'Book at Surya Spa', interests: ['spa'] },
                { time: '2:00 PM', title: 'Surya\'s Signature Abhyanga Massage', location: 'Surya Spa', description: 'Luxurious four-handed massage with customized warm herbalized oils.', price: 'Additional fee (15% off)', energyLevel: ['restorative', 'balanced'], bookingText: 'Book at Surya Spa', interests: ['spa'] },
                { time: '2:00 PM', title: 'Tennis Instruction', location: 'Top-Tier LA Courts', description: 'Elite personalized instruction with professional coaches for all skill levels.', price: 'Additional fee', energyLevel: ['high-activity', 'balanced'], bookingText: 'Reserve with Guest Relations', interests: ['outdoor'] },
                { time: '2:30 PM', title: 'Afternoon Wellness Bowl at Calabra', location: 'Calabra Restaurant', description: 'Falafel Bowl with green tahini, quinoa tabbouleh, and fresh vegetables.', price: 'Menu pricing', energyLevel: ['balanced', 'restorative'], bookingText: 'Reserve on OpenTable', interests: ['dining'] },
                { time: '3:00 PM', title: 'Beach Tennis with Ola', location: 'Santa Monica Beach', description: 'Hybrid sport combining tennis control with beach volleyball movement.', price: 'Additional fee', energyLevel: ['high-activity', 'balanced'], bookingText: 'Book Beach Tennis', interests: ['outdoor'] },
                { time: '3:00 PM', title: 'Wellness Juices & Smoothies', location: 'Pool Bar', description: 'Fresh Sunshine juice or Pacific Blue smoothie with spirulina and coconut.', price: 'Menu pricing', energyLevel: ['high-activity', 'balanced', 'restorative'], bookingText: 'Walk-in Available', interests: ['dining'] },
                { time: '3:00 PM', title: 'Proper Club Lounge - Afternoon Recharge', location: 'Proper Club Lounge', description: 'Afternoon wellness session with contrast therapy, saunas, and peaceful lounge relaxation.', price: '$195/day access', energyLevel: ['balanced', 'restorative'], bookingText: 'Purchase Day Pass', interests: ['recovery'] }
            ],
            
            eveningActivities: [
                { time: '4:00 PM', title: 'Surya Breathwork Session', location: 'Surya Spa', description: 'Guided breathing techniques for stress relief, energy balancing, and nervous system regulation.', price: 'Additional fee (15% off)', energyLevel: ['restorative', 'balanced'], bookingText: 'Book at Surya Spa', interests: ['spa'] },
                { time: '4:30 PM', title: 'Padel Session', location: 'Padel Courts', description: 'Fastest-growing racquet sport blending tennis and squash. Private sessions available.', price: 'Additional fee', energyLevel: ['high-activity', 'balanced'], bookingText: 'Reserve with Guest Relations', interests: ['outdoor'] },
                { time: '5:30 PM', title: 'Sunset Rooftop Yoga', location: 'Pool Deck', description: 'Evening yoga practice with panoramic ocean and city views.', price: 'Complimentary', energyLevel: ['restorative', 'balanced'], bookingText: 'Book with Concierge', interests: ['outdoor'] },
                { time: '5:30 PM', title: 'Wine & Mezze at Palma', location: 'Palma Lobby Lounge', description: 'Small plates and natural wines in the art-filled lobby lounge setting. Healthy mocktails also available.', price: 'Menu pricing', energyLevel: ['balanced', 'restorative'], bookingText: 'Reserve on OpenTable', interests: ['dining'] },
                { time: '6:00 PM', title: 'Proper Club Lounge - Evening Wind-Down', location: 'Proper Club Lounge', description: 'End your day with relaxing contrast therapy, infrared sauna, and tranquil atmosphere.', price: '$195/day access', energyLevel: ['balanced', 'restorative'], bookingText: 'Purchase Day Pass', interests: ['recovery'] },
                { time: '6:30 PM', title: 'Sunset Beach Walk', location: 'Santa Monica Beach', description: 'Guided mindful walk along the shore during golden hour.', price: 'Complimentary', energyLevel: ['restorative', 'balanced'], bookingText: 'Meet at Lobby', interests: ['outdoor'] },
                { time: '7:00 PM', title: 'Mediterranean Dinner at Calabra', location: 'Calabra Restaurant', description: 'Pan Seared Salmon, Crispy Eggplant Schnitzel, or Whole Roasted Branzino with ocean views.', price: 'Menu pricing', energyLevel: ['high-activity', 'balanced', 'restorative'], bookingText: 'Reserve on OpenTable', interests: ['dining'] },
                { time: '8:00 PM', title: 'Evening Cocktails & Mocktails at Palma', location: 'Palma Lobby Lounge', description: 'Small-batch mezcals, crafted cocktails, and healthy mocktails with light bites in artistic lobby setting.', price: 'Menu pricing', energyLevel: ['balanced', 'restorative'], bookingText: 'Walk-in Available', interests: ['dining'] },
                { time: '8:30 PM', title: 'Surya Sound Bath', location: 'Surya Spa', description: 'Healing sound frequencies and meditation for deep relaxation and stress relief.', price: 'Additional fee (15% off)', energyLevel: ['restorative'], bookingText: 'Book at Surya Spa', interests: ['spa'] }
            ]
        };

        // Track one-time activities used
        let usedOneTimeActivities = new Set();
        let usedRecoverySuite = null;
        let properClubDays = new Set();

        // Initialize the survey when page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateDisplay();
            setupAllEventListeners();
        });

        // Setup all event listeners
        function setupAllEventListeners() {
            setupStep1Listeners();
            setupStep2Listeners();
            setupStep3Listeners();
            setupStep4Listeners();
            setupStep5Listeners();
        }

        // Navigation functions
        function goToNextStep() {
            if (currentStep >= totalSteps) return;
            
            if (!isCurrentStepValid()) {
                alert('Please complete all required fields before proceeding.');
                return;
            }
            
            saveCurrentStepData();
            currentStep++;
            
            if (currentStep === totalSteps) {
                generateWellnessItinerary();
            }
            
            updateDisplay();
        }

        function goToPreviousStep() {
            if (currentStep <= 1) return;
            
            currentStep--;
            updateDisplay();
        }

        function updateDisplay() {
            // Update step indicators
            document.getElementById('current-step').textContent = currentStep;
            document.getElementById('total-steps').textContent = totalSteps;
            document.getElementById('step-title').textContent = stepTitles[currentStep - 1];
            
            // Show/hide step content
            document.querySelectorAll('.step-content').forEach((step, index) => {
                if (index + 1 === currentStep) {
                    step.classList.add('active');
                } else {
                    step.classList.remove('active');
                }
            });
            
            // Update navigation buttons
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const completeBtn = document.getElementById('complete-btn');
            
            // Previous button
            prevBtn.disabled = currentStep === 1;
            prevBtn.style.visibility = currentStep === 1 ? 'hidden' : 'visible';
            
            // Next/Complete buttons
            if (currentStep === totalSteps) {
                nextBtn.style.display = 'none';
                completeBtn.style.display = 'block';
            } else {
                nextBtn.style.display = 'block';
                completeBtn.style.display = 'none';
                
                // Validate current step and update next button
                const isValid = isCurrentStepValid();
                nextBtn.disabled = !isValid;
            }
        }

        // Validation functions
        function isCurrentStepValid() {
            switch (currentStep) {
                case 1:
                    return checkStep1();
                case 2:
                    return surveyData.energyLevel !== '';
                case 3:
                    return surveyData.interests.length > 0;
                case 4:
                    return surveyData.timing !== '';
                case 5:
                case 6:
                    return true;
                default:
                    return false;
            }
        }

        function checkStep1() {
            const name = document.getElementById('guest-names').value.trim();
            const party = document.getElementById('party-type').value;
            const arrival = document.getElementById('arrival-date').value;
            const length = document.getElementById('length-of-stay').value;
            
            return name && party && arrival && length;
        }

        function saveCurrentStepData() {
            switch (currentStep) {
                case 1:
                    surveyData.names = document.getElementById('guest-names').value.trim();
                    surveyData.partyType = document.getElementById('party-type').value;
                    surveyData.arrivalDate = document.getElementById('arrival-date').value;
                    surveyData.arrivalTime = document.getElementById('arrival-time').value;
                    surveyData.lengthOfStay = document.getElementById('length-of-stay').value;
                    surveyData.departureTime = document.getElementById('departure-time').value;
                    surveyData.travelPurpose = document.getElementById('travel-purpose').value;
                    break;
                case 5:
                    surveyData.notes = document.getElementById('special-notes').value;
                    break;
            }
        }

        // Setup event listeners for each step
        function setupStep1Listeners() {
            const fields = ['guest-names', 'party-type', 'arrival-date', 'length-of-stay'];
            fields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('input', updateDisplay);
                    field.addEventListener('change', updateDisplay);
                }
            });
        }

        function setupStep2Listeners() {
            const cards = document.querySelectorAll('#step-2 .option-card');
            cards.forEach(card => {
                card.addEventListener('click', () => {
                    // Clear previous selections
                    cards.forEach(c => c.classList.remove('selected'));
                    // Select current card
                    card.classList.add('selected');
                    surveyData.energyLevel = card.getAttribute('data-value');
                    updateDisplay();
                });
            });
        }

        function setupStep3Listeners() {
            const cards = document.querySelectorAll('#step-3 .option-card');
            cards.forEach(card => {
                card.addEventListener('click', () => {
                    const value = card.getAttribute('data-value');
                    
                    if (card.classList.contains('selected')) {
                        // Deselect
                        card.classList.remove('selected');
                        surveyData.interests = surveyData.interests.filter(item => item !== value);
                    } else {
                        // Select
                        card.classList.add('selected');
                        if (!surveyData.interests.includes(value)) {
                            surveyData.interests.push(value);
                        }
                    }
                    updateDisplay();
                });
            });
        }

        function setupStep4Listeners() {
            const cards = document.querySelectorAll('#step-4 .option-card');
            cards.forEach(card => {
                card.addEventListener('click', () => {
                    // Clear previous selections
                    cards.forEach(c => c.classList.remove('selected'));
                    // Select current card
                    card.classList.add('selected');
                    surveyData.timing = card.getAttribute('data-value');
                    updateDisplay();
                });
            });
        }

        function setupStep5Listeners() {
            const notesField = document.getElementById('special-notes');
            if (notesField) {
                notesField.addEventListener('input', () => {
                    surveyData.notes = notesField.value;
                });
            }
        }

        // Helper function to get day of week
        function getDayOfWeek(date) {
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            return days[date.getDay()];
        }

        // Enhanced itinerary generation with algorithm rules and loading
        function generateWellnessItinerary() {
            const resultsContainer = document.getElementById('step-6');
            const completeBtn = document.getElementById('complete-btn');
            
            // FORCE HIDE the complete button during loading
            completeBtn.style.display = 'none';
            
            // Show loading state WITHOUT any buttons
            resultsContainer.innerHTML = `
                <div class="text-center py-12">
                    <div class="loading-spinner mx-auto mb-6"></div>
                    <h3 class="smp-header text-sm tracking-wide uppercase mb-3">Creating Your Personalized Itinerary</h3>
                    <p class="smp-body text-xs leading-relaxed" style="color: #666666;">
                        Analyzing your preferences and optimizing your wellness experience...
                    </p>
                </div>
            `;
            
            // Add loading spinner CSS
            const style = document.createElement('style');
            style.textContent = `
                .loading-spinner {
                    width: 40px;
                    height: 40px;
                    border: 3px solid rgba(0, 0, 0, 0.1);
                    border-top: 3px solid #000000;
                    border-radius: 50%;
                    animation: spin 1s linear infinite;
                }
                
                @keyframes spin {
                    0% { transform: rotate(0deg); }
                    100% { transform: rotate(360deg); }
                }
            `;
            document.head.appendChild(style);
            
            // Wait 5 seconds then generate the actual itinerary
            setTimeout(() => {
                generateActualItinerary(resultsContainer);
                // ONLY NOW show the complete button after itinerary is fully generated
                completeBtn.style.display = 'block';
            }, 5000);
        }
        
        function generateActualItinerary(resultsContainer) {
            let numDays = parseInt(surveyData.lengthOfStay) || 2;
            if (surveyData.lengthOfStay === '6-7') numDays = 6;
            if (surveyData.lengthOfStay === 'week+') numDays = 7;
            
            // Reset tracking variables
            usedOneTimeActivities.clear();
            usedRecoverySuite = null;
            properClubDays.clear();
            
            const itineraryHTML = generateFullItinerary(numDays);
            
            // Format dates and times for display
            const arrivalDate = new Date(surveyData.arrivalDate);
            const departureDate = new Date(arrivalDate);
            departureDate.setDate(arrivalDate.getDate() + numDays);
            
            const formatDate = (date) => {
                return date.toLocaleDateString('en-US', { 
                    weekday: 'long',
                    month: 'long', 
                    day: 'numeric',
                    year: 'numeric'
                });
            };
            
            const formatArrivalTime = (timeCode) => {
                const timeMap = {
                    'early-morning': 'Early Morning (6-9 AM)',
                    'morning': 'Morning (9 AM-12 PM)',
                    'afternoon': 'Afternoon (12-4 PM)',
                    'evening': 'Evening (4-8 PM)',
                    'late-evening': 'Late Evening (8 PM+)'
                };
                return timeMap[timeCode] || 'Not specified';
            };
            
            const formatDepartureTime = (timeCode) => {
                const timeMap = {
                    'early-morning': 'Early Morning (6-9 AM)',
                    'morning': 'Morning (9 AM-12 PM)',
                    'afternoon': 'Afternoon (12-4 PM)',
                    'evening': 'Evening (4-8 PM)',
                    'flexible': 'Flexible/Late Checkout'
                };
                return timeMap[timeCode] || 'Not specified';
            };
            
            resultsContainer.innerHTML = 
                '<div class="profile-summary p-5 mb-6">' +
                '<h3 class="smp-header text-sm tracking-wide uppercase mb-3">Your Wellness Profile</h3>' +
                '<div class="grid gap-2 text-xs">' +
                '<div><strong>Guest(s):</strong> ' + surveyData.names + '</div>' +
                '<div><strong>Party Type:</strong> ' + surveyData.partyType + '</div>' +
                '<div><strong>Stay Duration:</strong> ' + surveyData.lengthOfStay + ' night(s)</div>' +
                '<div><strong>Energy Level:</strong> ' + surveyData.energyLevel + '</div>' +
                '<div><strong>Interests:</strong> ' + surveyData.interests.join(', ') + '</div>' +
                '<div><strong>Preferred Timing:</strong> ' + surveyData.timing + '</div>' +
                (surveyData.notes ? '<div><strong>Notes:</strong> ' + surveyData.notes + '</div>' : '') +
                '</div>' +
                '</div>' +
                '<div class="profile-summary p-5 mb-6">' +
                '<h3 class="smp-header text-sm tracking-wide uppercase mb-3">Stay Details</h3>' +
                '<div class="grid gap-2 text-xs">' +
                '<div><strong>Check-in:</strong> ' + formatDate(arrivalDate) + '</div>' +
                '<div><strong>Arrival Time:</strong> ' + formatArrivalTime(surveyData.arrivalTime) + '</div>' +
                '<div><strong>Check-out:</strong> ' + formatDate(departureDate) + '</div>' +
                '<div><strong>Departure Time:</strong> ' + formatDepartureTime(surveyData.departureTime) + '</div>' +
                '</div>' +
                '</div>' +
                itineraryHTML +
                '<div class="contact-section p-5 mb-6">' +
                '<h3 class="smp-header text-sm tracking-wide uppercase mb-3">Save Your Itinerary</h3>' +
                '<div class="grid grid-cols-2 gap-3 mb-4">' +
                '<button onclick="downloadPDF()" class="btn-primary smp-body px-3 py-2 text-xs tracking-wide uppercase">Download PDF</button>' +
                '<button onclick="emailItinerary()" class="btn-primary smp-body px-3 py-2 text-xs tracking-wide uppercase">Email to Me</button>' +
                '</div>' +
                '<p class="smp-body text-xs leading-relaxed mb-3">Your personalized wellness itinerary follows all operational guidelines and booking requirements. Activities are scheduled at actual class times and respect meal timing, energy levels, and preparation needs.</p>' +
                '<div class="mb-4">' +
                '<h4 class="smp-header text-xs tracking-wide uppercase mb-2">Quick Booking Links</h4>' +
                '<div class="grid grid-cols-1 gap-2 text-xs">' +
                '<a href="https://santa-monica-fitness.properhotel.com/" target="_blank" class="btn-primary smp-body px-3 py-1 text-xs tracking-wide uppercase inline-block" style="text-decoration: none;">View All Classes & Activities</a>' +
                '<a href="https://www.opentable.com/r/palma-santa-monica" target="_blank" class="btn-primary smp-body px-3 py-1 text-xs tracking-wide uppercase inline-block" style="text-decoration: none;">Reserve Palma Restaurant</a>' +
                '<a href="https://www.opentable.com/r/calabra-santa-monica" target="_blank" class="btn-primary smp-body px-3 py-1 text-xs tracking-wide uppercase inline-block" style="text-decoration: none;">Reserve Calabra Restaurant</a>' +
                '<a href="https://www.opentable.com/booking/experiences-availability?rid=1042708&restref=1042708&experienceId=498441&utm_source=external&utm_medium=referral&utm_campaign=shared" target="_blank" class="btn-primary smp-body px-3 py-1 text-xs tracking-wide uppercase inline-block" style="text-decoration: none;">Reserve Loreto Pop-Up</a>' +
                '<a href="https://na.spatime.com/susp401/4826280/home" target="_blank" class="btn-primary smp-body px-3 py-1 text-xs tracking-wide uppercase inline-block" style="text-decoration: none;">Book Surya Spa Treatments</a>' +
                '<a href="https://dashboard.boulevard.io/booking/businesses/aac8e693-831d-4030-b8f8-eb9238e089bc/widget#/cart/menu/Session%20Time" target="_blank" class="btn-primary smp-body px-3 py-1 text-xs tracking-wide uppercase inline-block" style="text-decoration: none;">Book Recovery Suite</a>' +
                '<a href="https://dashboard.boulevard.io/booking/businesses/aac8e693-831d-4030-b8f8-eb9238e089bc/widget#/cart/menu/Session%20Time" target="_blank" class="btn-primary smp-body px-3 py-1 text-xs tracking-wide uppercase inline-block" style="text-decoration: none;">Book VO2 Max Testing</a>' +
                '<a href="mailto:smp.guestrelations@properhotel.com?subject=Tennis, Padel & Beach Activities" class="btn-primary smp-body px-3 py-1 text-xs tracking-wide uppercase inline-block" style="text-decoration: none;">Book Tennis, Padel & Beach Activities</a>' +
                '<a href="mailto:wellness.smp@properhotel.com?subject=Proper Club Lounge Day Pass Request" class="btn-primary smp-body px-3 py-1 text-xs tracking-wide uppercase inline-block" style="text-decoration: none;">Request Proper Club Lounge Pass</a>' +
                '</div>' +
                '</div>' +
                '<div class="mb-3">' +
                '<p class="smp-body text-xs leading-relaxed" style="color: #666;">Loreto Pop-Up only available Thu-Sun through Sept 1, 2025 | Recovery Suite available 7am-8pm daily | Proper Club Lounge day passes available via wellness.smp@properhotel.com</p>' +
                '</div>' +
                '<p class="smp-body text-xs">Questions? Contact our wellness team at <strong>wellness@properhotel.com</strong></p>' +
                '</div>';
            
            setupSwapFunctionality();
        }

        function generateFullItinerary(numDays) {
            let itineraryHTML = '';
            const arrivalDate = new Date(surveyData.arrivalDate);
            
            for (let day = 1; day <= numDays; day++) {
                const currentDate = new Date(arrivalDate);
                currentDate.setDate(arrivalDate.getDate() + day - 1);
                const dateString = currentDate.toLocaleDateString('en-US', { 
                    weekday: 'long', 
                    month: 'long', 
                    day: 'numeric' 
                });
                const dayOfWeek = getDayOfWeek(currentDate);
                
                const dayActivities = generateDayActivities(day, numDays, dayOfWeek, currentDate);
                
                itineraryHTML += 
                    '<div class="day-container mb-6">' +
                    '<div class="day-header p-4 text-center">' +
                    '<h3 class="smp-header text-sm tracking-wide uppercase">Day ' + day + ' - ' + dateString + '</h3>' +
                    '</div>' +
                    '<div class="p-5">' + dayActivities + '</div>' +
                    '</div>';
            }
            
            return itineraryHTML;
        }

        function generateDayActivities(day, totalDays, dayOfWeek, currentDate) {
            let dayActivities = [];
            
            // Apply arrival/departure timing logic
            const isArrivalDay = day === 1;
            const isDepartureDay = day === totalDays;
            
            // Get user preferences
            const energyLevel = surveyData.energyLevel;
            const interests = surveyData.interests;
            const timing = surveyData.timing;
            
            // MORNING BLOCK (7:00 AM - 11:00 AM)
            if (!isArrivalDay || ['early-morning', 'morning'].includes(surveyData.arrivalTime)) {
                // 7:30 AM - Coffee service
                dayActivities.push({
                    time: '7:30 AM',
                    title: 'Morning Coffee & Tea Service',
                    location: 'Canela Lounge - Ground Floor',
                    description: 'Counter Culture Coffee and artisanal tea service to start your day.',
                    price: 'Complimentary',
                    bookingText: '',
                    timeCategory: 'morning'
                });
                
                // 8:00 AM - Fitness class if available
                if (wellnessDatabase.fitnessClasses[dayOfWeek]) {
                    const morningClasses = wellnessDatabase.fitnessClasses[dayOfWeek].filter(cls => {
                        const hour = parseInt(cls.time.split(':')[0]);
                        return hour >= 6 && hour <= 10;
                    });
                    
                    if (morningClasses.length > 0 && interests.includes('movement')) {
                        const matchingClass = morningClasses.find(cls => 
                            cls.energyLevel.includes(energyLevel)
                        ) || morningClasses[0];
                        dayActivities.push({
                            ...matchingClass,
                            timeCategory: 'morning'
                        });
                    }
                }
                
                // 9:00 AM - Breakfast
                dayActivities.push({
                    time: '9:00 AM',
                    title: 'Wellness Breakfast at Palma',
                    location: 'Palma Restaurant',
                    description: 'Greek Goddess Yogurt Parfait, Sprouted Overnight Oats, or Avocado Toast with fresh market fruit.',
                    price: 'Menu pricing',
                    bookingText: 'Reserve on OpenTable',
                    timeCategory: 'morning'
                });
                
                // 10:00 AM - Ayurvedic Lattes
                if (interests.includes('dining') || interests.includes('spa')) {
                    dayActivities.push({
                        time: '10:00 AM',
                        title: 'Surya Spa Ayurvedic Lattes',
                        location: 'Palma Restaurant',
                        description: 'Brainpower Latte, Whole Body Energy Latte, or Mighty Turmeric Latte crafted by Surya Spa.',
                        price: 'Menu pricing',
                        bookingText: 'Walk-in Available',
                        timeCategory: 'morning'
                    });
                }
            }
            
            // MID-DAY BLOCK (11:00 AM - 4:00 PM)
            if (!isDepartureDay || ['afternoon', 'evening', 'flexible'].includes(surveyData.departureTime)) {
                // 11:00 AM - Activity based on interests
                if (interests.includes('recovery') && !usedRecoverySuite && !properClubDays.has(day)) {
                    dayActivities.push({
                        time: '11:00 AM',
                        title: '60-Minute Recovery Suite',
                        location: 'Recovery Suite',
                        description: 'Fully immersive wellness experience with Ammortal Chamber, dry sauna, cold plunge, red light therapy.',
                        price: '$245',
                        bookingText: 'Reserve Recovery Suite',
                        timeCategory: 'midday'
                    });
                    usedRecoverySuite = '60-Minute Recovery Suite';
                } else {
                    dayActivities.push({
                        time: '11:00 AM',
                        title: 'Pool Time & Relaxation',
                        location: 'Pool Deck',
                        description: 'Unwind at the rooftop pool with stunning ocean views.',
                        price: 'Complimentary',
                        bookingText: 'Walk-in Available',
                        timeCategory: 'midday'
                    });
                }
                
                // 12:30 PM - Lunch
                const isThursdayToSunday = ['Thursday', 'Friday', 'Saturday', 'Sunday'].includes(dayOfWeek);
                const currentTime = new Date().getTime();
                const sept1_2025 = new Date('2025-09-01').getTime();
                const isBeforeSept1 = currentTime <= sept1_2025;
                
                if (interests.includes('dining') && isThursdayToSunday && isBeforeSept1) {
                    dayActivities.push({
                        time: '12:30 PM',
                        title: 'Loreto Pop-Up Experience',
                        location: 'Rooftop Terrace',
                        description: 'Baja-style ceviche, aguachiles, and tostadas (Thu-Sun 12PM-8PM, until Sept 1, 2025).',
                        price: 'Menu pricing',
                        bookingText: 'Reserve Table',
                        timeCategory: 'midday'
                    });
                } else {
                    dayActivities.push({
                        time: '12:30 PM',
                        title: 'Healthy Lunch at Palma',
                        location: 'Palma Restaurant',
                        description: 'Farmers Market Salad, Kale Pesto, or Pan Seared Salmon with Mediterranean sides.',
                        price: 'Menu pricing',
                        bookingText: 'Reserve on OpenTable',
                        timeCategory: 'midday'
                    });
                }
                
                // 2:00 PM - Interest-based activity
                if (interests.includes('spa')) {
                    dayActivities.push({
                        time: '2:00 PM',
                        title: 'Shirodhara Session',
                        location: 'Surya Spa',
                        description: 'Warm oil therapy streamed over your forehead for mental clarity and stress relief.',
                        price: 'Additional fee (15% off)',
                        bookingText: 'Book at Surya Spa',
                        timeCategory: 'midday'
                    });
                } else if (interests.includes('outdoor')) {
                    dayActivities.push({
                        time: '2:00 PM',
                        title: 'Tennis Instruction',
                        location: 'Top-Tier LA Courts',
                        description: 'Elite personalized instruction with professional coaches for all skill levels.',
                        price: 'Additional fee',
                        bookingText: 'Reserve with Guest Relations',
                        timeCategory: 'midday'
                    });
                }
                
                // 3:30 PM - Always include wellness juices
                dayActivities.push({
                    time: '3:30 PM',
                    title: 'Wellness Juices & Smoothies',
                    location: 'Pool Bar',
                    description: 'Fresh Sunshine juice or Pacific Blue smoothie with spirulina and coconut.',
                    price: 'Menu pricing',
                    bookingText: 'Walk-in Available',
                    timeCategory: 'midday'
                });
            }
            
            // EVENING BLOCK (5:30 PM - 9:00 PM)
            if (!isDepartureDay || ['evening', 'flexible'].includes(surveyData.departureTime)) {
                // 5:30 PM - Sunset activity
                if (interests.includes('outdoor')) {
                    dayActivities.push({
                        time: '5:30 PM',
                        title: 'Sunset Rooftop Yoga',
                        location: 'Pool Deck',
                        description: 'Evening yoga practice with panoramic ocean and city views.',
                        price: 'Complimentary',
                        bookingText: 'Book with Concierge',
                        timeCategory: 'evening'
                    });
                } else if (interests.includes('recovery') && !properClubDays.has(day) && usedRecoverySuite !== '60-Minute Recovery Suite') {
                    dayActivities.push({
                        time: '5:30 PM',
                        title: 'Proper Club Lounge - Evening Wind-Down',
                        location: 'Proper Club Lounge',
                        description: 'End your day with relaxing contrast therapy, infrared sauna, and tranquil atmosphere.',
                        price: '$195/day access',
                        bookingText: 'Purchase Day Pass',
                        timeCategory: 'evening'
                    });
                    properClubDays.add(day);
                }
                
                // 6:30 PM - Beach walk
                if (interests.includes('outdoor')) {
                    dayActivities.push({
                        time: '6:30 PM',
                        title: 'Sunset Beach Walk',
                        location: 'Santa Monica Beach',
                        description: 'Guided mindful walk along the shore during golden hour.',
                        price: 'Complimentary',
                        bookingText: 'Meet at Lobby',
                        timeCategory: 'evening'
                    });
                }
                
                // 7:30 PM - Always include dinner
                dayActivities.push({
                    time: '7:30 PM',
                    title: 'Mediterranean Dinner at Calabra',
                    location: 'Calabra Restaurant',
                    description: 'Pan Seared Salmon, Crispy Eggplant Schnitzel, or Whole Roasted Branzino with ocean views.',
                    price: 'Menu pricing',
                    bookingText: 'Reserve on OpenTable',
                    timeCategory: 'evening'
                });
                
                // 8:45 PM - Always include evening cocktails
                dayActivities.push({
                    time: '8:45 PM',
                    title: 'Evening Cocktails & Mocktails at Palma',
                    location: 'Palma Lobby Lounge',
                    description: 'Small-batch mezcals, crafted cocktails, and healthy mocktails with light bites in artistic lobby setting.',
                    price: 'Menu pricing',
                    bookingText: 'Walk-in Available',
                    timeCategory: 'evening'
                });
            }
            
            // Special Day 2 activities
            if (day === 2 && interests.includes('movement') && !usedOneTimeActivities.has('VO2 Max Testing')) {
                // Replace 10:30 AM activity with VO2 Max testing
                const vo2Activity = {
                    time: '10:30 AM',
                    title: 'VO2 Max Testing Session',
                    location: 'Performance Lab - Fitness Center',
                    description: 'Professional VO2 max test measuring maximal oxygen uptake. Includes digital report.',
                    price: '$150',
                    bookingText: 'Book VO2 Testing',
                    timeCategory: 'morning'
                };
                
                // Insert VO2 activity in correct chronological position
                let inserted = false;
                for (let i = 0; i < dayActivities.length; i++) {
                    if (dayActivities[i].time === '10:30 AM' || (parseInt(dayActivities[i].time.split(':')[0]) > 10)) {
                        dayActivities.splice(i, 0, vo2Activity);
                        inserted = true;
                        break;
                    }
                }
                if (!inserted) {
                    dayActivities.push(vo2Activity);
                }
                usedOneTimeActivities.add('VO2 Max Testing');
            }
            
            // Sort activities by time
            dayActivities.sort((a, b) => {
                const timeA = convertTimeToMinutes(a.time);
                const timeB = convertTimeToMinutes(b.time);
                return timeA - timeB;
            });
            
            // Generate HTML for day activities
            let dayHTML = '';
            dayActivities.forEach((activity, index) => {
                const swappable = activity.swappable !== false;
                
                // Create booking link HTML
                let bookingHTML = '';
                if (activity.bookingText) {
                    if (activity.eventbriteUrl) {
                        bookingHTML = `<strong>Booking:</strong> <a href="${activity.eventbriteUrl}" target="_blank" style="color: #000; text-decoration: underline;">${activity.bookingText}</a>`;
                    } else if (activity.bookingText === 'Reserve on OpenTable' && activity.location.includes('Palma')) {
                        bookingHTML = `<strong>Booking:</strong> <a href="https://www.opentable.com/r/palma-santa-monica" target="_blank" style="color: #000; text-decoration: underline;">${activity.bookingText}</a>`;
                    } else if (activity.bookingText === 'Reserve on OpenTable' && activity.location.includes('Calabra')) {
                        bookingHTML = `<strong>Booking:</strong> <a href="https://www.opentable.com/r/calabra-santa-monica" target="_blank" style="color: #000; text-decoration: underline;">${activity.bookingText}</a>`;
                    } else if (activity.bookingText === 'Reserve Table' && activity.title.includes('Loreto')) {
                        bookingHTML = `<strong>Booking:</strong> <a href="https://www.opentable.com/booking/experiences-availability?rid=1042708&restref=1042708&experienceId=498441&utm_source=external&utm_medium=referral&utm_campaign=shared" target="_blank" style="color: #000; text-decoration: underline;">${activity.bookingText}</a>`;
                    } else if (activity.bookingText === 'Book at Surya Spa') {
                        bookingHTML = `<strong>Booking:</strong> <a href="https://na.spatime.com/susp401/4826280/home" target="_blank" style="color: #000; text-decoration: underline;">${activity.bookingText}</a>`;
                    } else if (activity.bookingText === 'Reserve Recovery Suite') {
                        bookingHTML = `<strong>Booking:</strong> <a href="https://dashboard.boulevard.io/booking/businesses/aac8e693-831d-4030-b8f8-eb9238e089bc/widget#/cart/menu/Session%20Time" target="_blank" style="color: #000; text-decoration: underline;">${activity.bookingText}</a>`;
                    } else if (activity.bookingText === 'Book VO2 Testing') {
                        bookingHTML = `<strong>Booking:</strong> <a href="https://dashboard.boulevard.io/booking/businesses/aac8e693-831d-4030-b8f8-eb9238e089bc/widget#/cart/menu/Session%20Time" target="_blank" style="color: #000; text-decoration: underline;">${activity.bookingText}</a>`;
                    } else if (activity.bookingText === 'Reserve with Guest Relations') {
                        const subject = activity.emailSubject || 'Wellness Activity Booking';
                        bookingHTML = `<strong>Booking:</strong> <a href="mailto:smp.guestrelations@properhotel.com?subject=${encodeURIComponent(subject)}" style="color: #000; text-decoration: underline;">${activity.bookingText}</a>`;
                    } else if (activity.bookingText === 'Book Beach Tennis') {
                        bookingHTML = `<strong>Booking:</strong> <a href="mailto:smp.guestrelations@properhotel.com?subject=Book%20Beach%20Tennis" style="color: #000; text-decoration: underline;">${activity.bookingText}</a>`;
                    } else if (activity.bookingText === 'Join on Eventbrite') {
                        bookingHTML = `<strong>Booking:</strong> <a href="${activity.eventbriteUrl}" target="_blank" style="color: #000; text-decoration: underline;">${activity.bookingText}</a>`;
                    } else if (activity.bookingText === 'Purchase Day Pass') {
                        bookingHTML = `<strong>Booking:</strong> <a href="mailto:wellness.smp@properhotel.com?subject=Proper%20Club%20Lounge%20Day%20Pass%20Request" style="color: #000; text-decoration: underline;">${activity.bookingText}</a>`;
                    } else {
                        bookingHTML = `<strong>Booking:</strong> ${activity.bookingText}`;
                    }
                }
                
                dayHTML += 
                    '<div class="activity-item' + (swappable ? ' swappable' : '') + '" data-activity-index="' + index + '" data-time-category="' + (activity.timeCategory || 'general') + '">' +
                    '<div class="activity-time">' + activity.time + '</div>' +
                    '<div class="activity-content">' +
                    '<div class="activity-title">' + activity.title + '</div>' +
                    '<div class="activity-location">' + activity.location + '</div>' +
                    '<div class="activity-description">' + activity.description + '</div>' +
                    '<div class="text-xs mt-2" style="color: #888888;">' +
                    (activity.price === 'Complimentary' ? 'Complimentary' : 
                     activity.price === 'Available' ? '' : 
                     activity.price === 'Menu pricing' ? 'Menu pricing' : 
                     activity.price) +
                    (bookingHTML ? (activity.price === 'Available' ? '' : ' | ') + bookingHTML : '') +
                    '</div>' +
                    '</div>';
                
                if (swappable) {
                    dayHTML += '<button class="swap-btn" onclick="toggleSwapOptions(this)">Swap</button>' +
                              '<div class="swap-options"></div>';
                }
                
                dayHTML += '</div>';
            });
            
            return dayHTML;
        }
        
        function convertTimeToMinutes(timeStr) {
            const [time, period] = timeStr.split(' ');
            let [hours, minutes] = time.split(':').map(Number);
            
            if (period === 'PM' && hours !== 12) {
                hours += 12;
            } else if (period === 'AM' && hours === 12) {
                hours = 0;
            }
            
            return hours * 60 + minutes;
        }
        
        function setupSwapFunctionality() {
            // Implementation for swap functionality would go here
            // This is a placeholder for the swap system
        }
        
        function toggleSwapOptions(button) {
            const swapOptions = button.nextElementSibling;
            const activityItem = button.closest('.activity-item');
            const timeCategory = activityItem.getAttribute('data-time-category');
            
            if (swapOptions.classList.contains('active')) {
                swapOptions.classList.remove('active');
                return;
            }
            
            // Close other open swap options
            document.querySelectorAll('.swap-options.active').forEach(options => {
                options.classList.remove('active');
            });
            
            // Generate swap options based on time category
            const availableSwaps = getSwapOptions(timeCategory);
            let swapHTML = '';
            
            availableSwaps.forEach(option => {
                swapHTML += 
                    '<div class="swap-option" onclick="swapActivity(this)">' +
                    '<div style="font-weight: 600;">' + option.title + '</div>' +
                    '<div style="color: #666; font-size: 10px;">' + option.location + ' | ' + option.price + '</div>' +
                    '</div>';
            });
            
            swapOptions.innerHTML = swapHTML;
            swapOptions.classList.add('active');
        }
        
        function getSwapOptions(timeCategory) {
            const energyLevel = surveyData.energyLevel;
            const interests = surveyData.interests;
            
            let availableOptions = [];
            
            switch (timeCategory) {
                case 'morning':
                    availableOptions = wellnessDatabase.morningActivities;
                    break;
                case 'midday':
                    availableOptions = wellnessDatabase.midDayActivities;
                    break;
                case 'evening':
                    availableOptions = wellnessDatabase.eveningActivities;
                    break;
                default:
                    availableOptions = [...wellnessDatabase.morningActivities, ...wellnessDatabase.midDayActivities, ...wellnessDatabase.eveningActivities];
            }
            
            // Filter by energy level and interests
            const filtered = availableOptions.filter(option => {
                const energyMatch = !option.energyLevel || option.energyLevel.includes(energyLevel);
                const interestMatch = !option.interests || option.interests.some(interest => interests.includes(interest));
                
                // Special Loreto Pop-Up filtering
                if (option.title === 'Loreto Pop-Up Experience') {
                    const currentTime = new Date().getTime();
                    const sept1_2025 = new Date('2025-09-01').getTime();
                    const isBeforeSept1 = currentTime <= sept1_2025;
                    
                    // Only show Loreto for midday category, Thu-Sun, and before Sept 1, 2025
                    if (timeCategory !== 'midday' || !isBeforeSept1) {
                        return false;
                    }
                    
                    // Check if it's Thursday-Sunday (this would need day context which we don't have in swap)
                    // For now, we'll allow it and let the booking handle the restriction
                }
                
                return energyMatch && interestMatch;
            });
            
            // Limit to 8 options and prioritize complimentary activities
            return filtered.sort((a, b) => {
                if (a.price === 'Complimentary' && b.price !== 'Complimentary') return -1;
                if (b.price === 'Complimentary' && a.price !== 'Complimentary') return 1;
                return 0;
            }).slice(0, 8);
        }
        
        function swapActivity(optionElement) {
            // Implementation for actual activity swapping would go here
            // This is a placeholder
            optionElement.closest('.swap-options').classList.remove('active');
        }
        
        function downloadPDF() {
            // Create a new window with the itinerary content for printing/PDF
            const printWindow = window.open('', '_blank');
            const itineraryContent = document.getElementById('step-6').innerHTML;
            
            // Format dates for the title
            const arrivalDate = new Date(surveyData.arrivalDate);
            const formatDate = (date) => {
                return date.toLocaleDateString('en-US', { 
                    month: 'long', 
                    day: 'numeric',
                    year: 'numeric'
                });
            };
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Wellness Itinerary - ${surveyData.names} - ${formatDate(arrivalDate)}</title>
                    <style>
                        body {
                            font-family: Georgia, serif;
                            line-height: 1.6;
                            margin: 40px;
                            color: #000;
                            background: white;
                        }
                        .header {
                            text-align: center;
                            margin-bottom: 40px;
                            border-bottom: 2px solid #000;
                            padding-bottom: 20px;
                        }
                        .header h1 {
                            font-size: 24px;
                            margin: 0;
                            text-transform: uppercase;
                            letter-spacing: 2px;
                        }
                        .header h2 {
                            font-size: 18px;
                            margin: 10px 0 0 0;
                            font-weight: normal;
                        }
                        .profile-summary, .contact-section {
                            background: #f9f9f9;
                            padding: 20px;
                            margin: 20px 0;
                            border: 1px solid #ddd;
                        }
                        .day-container {
                            margin: 30px 0;
                            break-inside: avoid;
                        }
                        .day-header {
                            background: #000;
                            color: white;
                            padding: 15px;
                            text-align: center;
                            font-size: 16px;
                            text-transform: uppercase;
                            letter-spacing: 1px;
                        }
                        .activity-item {
                            padding: 15px;
                            border-bottom: 1px solid #eee;
                            display: flex;
                            gap: 20px;
                        }
                        .activity-time {
                            font-weight: bold;
                            width: 100px;
                            flex-shrink: 0;
                        }
                        .activity-title {
                            font-weight: bold;
                            text-transform: uppercase;
                            font-size: 12px;
                            letter-spacing: 1px;
                            margin-bottom: 5px;
                        }
                        .activity-location {
                            color: #666;
                            font-size: 11px;
                            margin-bottom: 8px;
                        }
                        .activity-description {
                            font-size: 12px;
                            line-height: 1.4;
                            margin-bottom: 8px;
                        }
                        .swap-btn, .swap-options {
                            display: none !important;
                        }
                        @media print {
                            body { margin: 20px; }
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>Santa Monica Proper</h1>
                        <h2>Wellness Experience Itinerary</h2>
                        <p><strong>${surveyData.names}</strong> | ${formatDate(arrivalDate)}</p>
                    </div>
                    ${itineraryContent}
                    <div class="no-print" style="text-align: center; margin-top: 40px;">
                        <button onclick="window.print()" style="background: #000; color: white; padding: 15px 30px; border: none; cursor: pointer; text-transform: uppercase; letter-spacing: 1px;">Print / Save as PDF</button>
                    </div>
                </body>
                </html>
            `);
            
            printWindow.document.close();
            
            // Auto-print after a short delay to allow content to load
            setTimeout(() => {
                printWindow.print();
            }, 500);
        }
        
        function emailItinerary() {
            // Get guest email or prompt for it
            let guestEmail = prompt('Please enter your email address to receive your wellness itinerary:');
            
            if (!guestEmail) {
                return; // User cancelled
            }
            
            // Basic email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(guestEmail)) {
                alert('Please enter a valid email address.');
                return;
            }
            
            // Format the itinerary for email
            const arrivalDate = new Date(surveyData.arrivalDate);
            const formatDate = (date) => {
                return date.toLocaleDateString('en-US', { 
                    weekday: 'long',
                    month: 'long', 
                    day: 'numeric',
                    year: 'numeric'
                });
            };
            
            // Extract the complete itinerary from the displayed content
            let fullItinerary = '';
            const dayContainers = document.querySelectorAll('.day-container');
            
            dayContainers.forEach(dayContainer => {
                const dayHeader = dayContainer.querySelector('.day-header h3');
                if (dayHeader) {
                    fullItinerary += '\n' + '='.repeat(50) + '\n';
                    fullItinerary += dayHeader.textContent.toUpperCase() + '\n';
                    fullItinerary += '='.repeat(50) + '\n\n';
                }
                
                const activities = dayContainer.querySelectorAll('.activity-item');
                activities.forEach(activity => {
                    const time = activity.querySelector('.activity-time');
                    const title = activity.querySelector('.activity-title');
                    const location = activity.querySelector('.activity-location');
                    const description = activity.querySelector('.activity-description');
                    const priceInfo = activity.querySelector('.text-xs');
                    
                    if (time && title) {
                        fullItinerary += `${time.textContent} - ${title.textContent}\n`;
                        if (location) fullItinerary += `Location: ${location.textContent}\n`;
                        if (description) fullItinerary += `${description.textContent}\n`;
                        if (priceInfo) {
                            // Clean up the price info text
                            const cleanPriceInfo = priceInfo.textContent
                                .replace(/Price:\s*/g, 'Price: ')
                                .replace(/Booking:\s*/g, 'Booking: ')
                                .replace(/\s+/g, ' ')
                                .trim();
                            fullItinerary += `${cleanPriceInfo}\n`;
                        }
                        fullItinerary += '\n';
                    }
                });
            });
            
            // Get wellness profile info
            const profileElements = document.querySelectorAll('.profile-summary');
            let profileInfo = '';
            
            profileElements.forEach(profile => {
                const profileDivs = profile.querySelectorAll('div div');
                profileDivs.forEach(div => {
                    if (div.textContent.includes(':')) {
                        profileInfo += div.textContent + '\n';
                    }
                });
                profileInfo += '\n';
            });
            
            // Create email subject and body with FULL itinerary
            const subject = `Your Santa Monica Proper Wellness Itinerary - ${surveyData.names}`;
            const body = `Dear ${surveyData.names},

Thank you for completing your Wellness Experience Survey! Below is your complete personalized wellness itinerary for your stay at Santa Monica Proper.

${profileInfo}

YOUR COMPLETE WELLNESS ITINERARY:
${fullItinerary}

BOOKING INFORMATION & IMPORTANT NOTES:
• Fitness Classes: Book at Front Desk - All classes are complimentary
• Spa Treatments: Book at Surya Spa (15% guest discount automatically applied)
• Recovery Suite: Reserve in advance - $245 (60-min) or $345 (90-min)
• Restaurants: Reserve on OpenTable for best availability
• Proper Club Lounge: $195/day pass (includes all amenities)
• VO2 Max Testing: $150 per session (includes digital report)

OPERATIONAL HOURS & RESTRICTIONS:
• Loreto Pop-Up: Available Thursday-Sunday only through September 1, 2025
• Recovery Suite: Available daily 7:00 AM - 8:00 PM
• Fitness Center: 24/7 access for hotel guests
• Pool Deck: Seasonal hours, check with concierge

CONTACT INFORMATION:
• Wellness Team: wellness@properhotel.com
• Front Desk: For fitness class bookings
• Concierge: For activity reservations and local recommendations
• Surya Spa: For all spa treatment bookings

We look forward to welcoming you for an exceptional wellness experience at Santa Monica Proper!

Best regards,
The Santa Monica Proper Wellness Team

---
Santa Monica Proper Hotel
700 Wilshire Blvd, Santa Monica, CA 90401`;

            // Open email client with pre-filled content
            const mailtoLink = `mailto:${guestEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            
            // Try to open the email client
            try {
                window.location.href = mailtoLink;
                
                // Show confirmation message
                setTimeout(() => {
                    alert(`Complete wellness itinerary prepared for ${guestEmail}! Please check your email client to send. The email includes your full day-by-day schedule with all activities, times, locations, and booking information.`);
                }, 1000);
                
            } catch (error) {
                // Fallback: copy to clipboard
                navigator.clipboard.writeText(body).then(() => {
                    alert(`Complete itinerary copied to clipboard! Please paste into your email client and send to ${guestEmail}.`);
                }).catch(() => {
                    alert(`Please copy your complete itinerary and email to ${guestEmail}. Contact wellness@properhotel.com if you need assistance.`);
                });
            }
        }
    </script>
</body>
</html>